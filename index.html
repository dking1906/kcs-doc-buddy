<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
  <title>DocBuddy‚Ñ¢ Pro</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }
    :root {
      --bg: #0b0f14;
      --panel: #111826;
      --accent: #7aa2ff;
      --text: #e6edf3;
      --muted: #aab6c2;
      --success: #3fb950;
      --border: #233044;
    }
    body {
      background: var(--bg);
      color: var(--text);
      padding: 16px;
      padding-bottom: 100px;
      min-height: 100vh;
    }
    .header {
      text-align: center;
      padding: 24px;
      background: var(--panel);
      border-radius: 40px;
      margin-bottom: 24px;
      border: 1px solid var(--border);
    }
    .header h1 {
      color: var(--accent);
      font-size: 2rem;
    }
    .badge {
      background: rgba(63,185,80,0.1);
      color: var(--success);
      padding: 6px 16px;
      border-radius: 60px;
      font-size: 0.8rem;
      display: inline-block;
      margin-top: 8px;
      border: 1px solid var(--success);
    }
    .progress {
      display: flex;
      justify-content: space-between;
      margin: 30px 0;
      position: relative;
    }
    .progress::before {
      content: '';
      position: absolute;
      top: 20px;
      left: 0;
      right: 0;
      height: 3px;
      background: var(--border);
      z-index: 1;
    }
    .step {
      width: 44px;
      height: 44px;
      border-radius: 50%;
      background: var(--panel);
      border: 3px solid var(--border);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      z-index: 2;
    }
    .step.active {
      background: var(--accent);
      border-color: var(--accent);
      color: #0b0f14;
    }
    .card {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 30px;
      padding: 28px;
      margin-bottom: 24px;
    }
    .card h2 {
      margin-bottom: 24px;
    }
    label {
      display: block;
      font-size: 0.75rem;
      color: var(--accent);
      text-transform: uppercase;
      margin-bottom: 8px;
    }
    input, select {
      width: 100%;
      padding: 18px 22px;
      border-radius: 30px;
      border: 1.5px solid var(--border);
      background: #0a0e14;
      color: white;
      font-size: 1rem;
      margin-bottom: 20px;
    }
    .row {
      display: flex;
      gap: 16px;
      flex-wrap: wrap;
    }
    .row > div {
      flex: 1 1 150px;
    }
    .upload-zone {
      border: 2px dashed var(--border);
      border-radius: 30px;
      padding: 40px;
      text-align: center;
      margin: 20px 0;
      background: #0a0e14;
    }
    .checkbox-group {
      background: rgba(0,0,0,0.3);
      border-radius: 20px;
      padding: 20px;
      margin: 20px 0;
      border-left: 4px solid var(--accent);
    }
    .checkbox-item {
      display: flex;
      gap: 16px;
      margin: 16px 0;
    }
    .checkbox-item input {
      width: 24px;
      height: 24px;
      margin: 0;
    }
    .license-status {
      background: #0a0e14;
      padding: 18px;
      border-radius: 30px;
      margin: 20px 0;
      text-align: center;
      font-weight: 500;
    }
    .footer {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--panel);
      border-top: 1px solid var(--border);
      padding: 16px 20px;
      display: flex;
      gap: 16px;
    }
    .btn {
      flex: 1;
      padding: 18px;
      border-radius: 60px;
      border: none;
      font-weight: 700;
      font-size: 1.1rem;
      cursor: pointer;
    }
    .btn-primary {
      background: var(--accent);
      color: #0b0f14;
    }
    .btn-secondary {
      background: transparent;
      color: var(--muted);
      border: 1px solid var(--border);
    }
    .hidden { display: none !important; }
    #toast {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: black;
      color: white;
      padding: 16px 32px;
      border-radius: 60px;
      z-index: 9999;
      display: none;
      border-left: 6px solid var(--accent);
    }
  </style>
</head>
<body>

<div id="toast"></div>

<div class="header">
  <h1>DOCBUDDY‚Ñ¢ PRO</h1>
  <div class="badge">LIFETIME ACCESS ¬∑ GUMROAD VERIFIED</div>
</div>

<div class="progress">
  <div class="step active" id="step1">1</div>
  <div class="step" id="step2">2</div>
  <div class="step" id="step3">3</div>
</div>

<div id="step1Content">
  <div class="card">
    <h2>‚ö° Profile Builder</h2>
    <label>Full Name</label>
    <input type="text" id="fullName" placeholder="John Doe">
    <div class="row">
      <div><label>Birth Date</label><input type="date" id="birthDate"></div>
      <div><label>SSN (Last 4)</label><input type="text" id="ssn" maxlength="4"></div>
    </div>
    <label>State</label>
    <select id="state">
      <option value="">Select State</option>
      <option value="AL">Alabama</option>
      <option value="CA">California</option>
      <option value="TX">Texas</option>
      <option value="NY">New York</option>
      <option value="FL">Florida</option>
    </select>
    <label>City</label>
    <select id="city" disabled><option>Select state first</option></select>
    <div class="checkbox-group">
      <div class="checkbox-item"><input type="checkbox" id="disc1"><label>I certify this information is accurate</label></div>
    </div>
  </div>
</div>

<div id="step2Content" class="hidden">
  <div class="card">
    <h2>üîí Evidence Vault</h2>
    <div class="upload-zone" onclick="document.getElementById('fileInput').click()">
      <input type="file" id="fileInput" accept="image/*,application/pdf">
      <span>üì∏ Upload ID</span>
    </div>
    <div id="fileFeedback"></div>
    <div class="checkbox-group">
      <div class="checkbox-item"><input type="checkbox" id="disc2"><label>I confirm this is my genuine ID</label></div>
    </div>
  </div>
</div>

<div id="step3Content" class="hidden">
  <div class="card">
    <h2>‚öôÔ∏è Activate</h2>
    <label>Document Type</label>
    <select id="docType">
      <option value="FCRA">Credit Dispute (FCRA)</option>
      <option value="FDCPA">Debt Validation (FDCPA)</option>
    </select>
    <label>Gumroad License Key</label>
    <input type="text" id="licenseKey" placeholder="XXXX-XXXX-XXXX-XXXX">
    <div class="license-status" id="licenseStatus">Enter your license key to unlock</div>
    <div class="checkbox-group">
      <div class="checkbox-item"><input type="checkbox" id="disc3"><label>I am acting pro se</label></div>
    </div>
  </div>
</div>

<div class="footer">
  <button class="btn btn-secondary" id="backBtn" onclick="navigate(-1)">Back</button>
  <button class="btn btn-primary" id="nextBtn" onclick="navigate(1)">Continue</button>
</div>

<script>
  // -------------------- GUMROAD LIVE VERIFICATION --------------------
  const GUMROAD_PRODUCT_ID = 'E-_K-RW0Kbc-C8rR7Hqvow==';
  const GUMROAD_TOKEN = 'PmB-ESVOTyCn-6M9zS3FmIUkAUtetEzKRPUMcupabK4';

  let currentStep = 1;
  let fileValid = false;

  const cities = {
    'AL': ['Birmingham', 'Montgomery', 'Mobile'],
    'CA': ['Los Angeles', 'San Francisco', 'San Diego'],
    'TX': ['Houston', 'Austin', 'Dallas'],
    'NY': ['New York', 'Buffalo', 'Albany'],
    'FL': ['Miami', 'Orlando', 'Tampa']
  };

  function showToast(msg, isError = false) {
    const toast = document.getElementById('toast');
    toast.textContent = msg;
    toast.style.display = 'block';
    toast.style.borderLeftColor = isError ? 'var(--danger)' : 'var(--accent)';
    setTimeout(() => toast.style.display = 'none', 4000);
  }

  document.getElementById('state').addEventListener('change', function() {
    const state = this.value;
    const citySelect = document.getElementById('city');
    citySelect.innerHTML = '';
    if (cities[state]) {
      citySelect.disabled = false;
      cities[state].forEach(city => {
        const option = document.createElement('option');
        option.value = city;
        option.textContent = city;
        citySelect.appendChild(option);
      });
    } else {
      citySelect.disabled = true;
      citySelect.innerHTML = '<option>Select state first</option>';
    }
  });

  document.getElementById('fileInput').addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (file) {
      if (file.size > 10 * 1024 * 1024) {
        showToast('File too large (max 10MB)', true);
        fileValid = false;
      } else {
        fileValid = true;
        document.getElementById('fileFeedback').textContent = `‚úÖ ${file.name}`;
      }
    }
  });

  async function verifyLicense(key) {
    const statusDiv = document.getElementById('licenseStatus');
    statusDiv.innerHTML = '‚è≥ Verifying...';
    
    try {
      const response = await fetch('https://api.gumroad.com/v2/licenses/verify', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          product_id: GUMROAD_PRODUCT_ID,
          license_key: key,
          access_token: GUMROAD_TOKEN
        })
      });
      
      const data = await response.json();
      
      if (data.success && data.purchase && !data.purchase.refunded) {
        statusDiv.innerHTML = '‚úÖ License verified ‚Äî access granted';
        statusDiv.style.color = 'var(--success)';
        return true;
      } else {
        statusDiv.innerHTML = '‚ùå Invalid or expired license';
        statusDiv.style.color = 'var(--danger)';
        return false;
      }
    } catch (error) {
      statusDiv.innerHTML = '‚ö†Ô∏è Verification service unavailable';
      statusDiv.style.color = 'var(--warning)';
      return false;
    }
  }

  let verifyTimeout;
  document.getElementById('licenseKey').addEventListener('input', function() {
    clearTimeout(verifyTimeout);
    if (this.value.length > 10) {
      verifyTimeout = setTimeout(async () => {
        await verifyLicense(this.value);
      }, 500);
    }
  });

  async function navigate(dir) {
    const newStep = currentStep + dir;
    
    if (dir === 1) {
      if (currentStep === 1) {
        if (!document.getElementById('fullName').value) {
          showToast('Name is required', true); return;
        }
        if (!document.getElementById('state').value) {
          showToast('State is required', true); return;
        }
        if (!document.getElementById('disc1').checked) {
          showToast('Please check the disclosure', true); return;
        }
      }
      
      if (currentStep === 2) {
        if (!fileValid) {
          showToast('Please upload your ID', true); return;
        }
        if (!document.getElementById('disc2').checked) {
          showToast('Please confirm your ID is genuine', true); return;
        }
      }
      
      if (currentStep === 3) {
        const key = document.getElementById('licenseKey').value;
        if (!key) {
          showToast('Please enter your license key', true); return;
        }
        if (!document.getElementById('disc3').checked) {
          showToast('Please check the final disclosure', true); return;
        }
        
        const isValid = await verifyLicense(key);
        if (!isValid) return;
        
        showToast('‚úÖ Documents generated successfully!');
        return;
      }
    }
    
    if (newStep >= 1 && newStep <= 3) {
      currentStep = newStep;
      document.getElementById('step1Content').className = currentStep === 1 ? '' : 'hidden';
      document.getElementById('step2Content').className = currentStep === 2 ? '' : 'hidden';
      document.getElementById('step3Content').className = currentStep === 3 ? '' : 'hidden';
      document.getElementById('step1').className = currentStep >= 1 ? 'step active' : 'step';
      document.getElementById('step2').className = currentStep >= 2 ? 'step active' : 'step';
      document.getElementById('step3').className = currentStep >= 3 ? 'step active' : 'step';
      document.getElementById('backBtn').className = currentStep === 1 ? 'hidden' : 'btn btn-secondary';
      document.getElementById('nextBtn').textContent = currentStep === 3 ? 'Generate' : 'Continue';
    }
  }

  window.navigate = navigate;
  window.showToast = showToast;
</script>

</body>
</html>